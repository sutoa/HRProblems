First Cut 
Time: 2 min 11 sec
Mem:

Second Cut - with ImpactedPositions Cache
Time: 1 min 35 sec
Âª